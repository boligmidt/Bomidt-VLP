(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{332:function(t,e,r){"use strict";r.d(e,"a",(function(){return I}));var i=r(2),a=r(333),n=r(4),o=r(13),c=r(57),s=r(5),u=!1;function l(){var t=!u;return Object(n.y)()||(u=!0),t}var d=function(){function t(){}return t.prototype.ensureReady=function(){return Promise.resolve()},t.prototype.canBypassInit=function(){return!0},t.prototype.match=function(t,e,r){var i=r.store.get(t.id),a="ROOT_QUERY"===t.id;if(!i)return a;var n=i.__typename,o=void 0===n?a&&"Query":n;return o&&o===e||(l(),"heuristic")},t}(),f=(function(){function t(t){t&&t.introspectionQueryResultData?(this.possibleTypesMap=this.parseIntrospectionResult(t.introspectionQueryResultData),this.isReady=!0):this.isReady=!1,this.match=this.match.bind(this)}t.prototype.match=function(t,e,r){Object(s.b)(this.isReady,6);var i=r.store.get(t.id),a="ROOT_QUERY"===t.id;if(!i)return a;var n=i.__typename,o=void 0===n?a&&"Query":n;if(Object(s.b)(o,7),o===e)return!0;var c=this.possibleTypesMap[e];return!!(o&&c&&c.indexOf(o)>-1)},t.prototype.parseIntrospectionResult=function(t){var e={};return t.__schema.types.forEach((function(t){"UNION"!==t.kind&&"INTERFACE"!==t.kind||(e[t.name]=t.possibleTypes.map((function(t){return t.name})))})),e}}(),Object.prototype.hasOwnProperty),p=function(){function t(t){var e=this;void 0===t&&(t=Object.create(null)),this.data=t,this.depend=Object(c.b)((function(t){return e.data[t]}),{disposable:!0,makeCacheKey:function(t){return t}})}return t.prototype.toObject=function(){return this.data},t.prototype.get=function(t){return this.depend(t),this.data[t]},t.prototype.set=function(t,e){e!==this.data[t]&&(this.data[t]=e,this.depend.dirty(t))},t.prototype.delete=function(t){f.call(this.data,t)&&(delete this.data[t],this.depend.dirty(t))},t.prototype.clear=function(){this.replace(null)},t.prototype.replace=function(t){var e=this;t?(Object.keys(t).forEach((function(r){e.set(r,t[r])})),Object.keys(this.data).forEach((function(r){f.call(t,r)||e.delete(r)}))):Object.keys(this.data).forEach((function(t){e.delete(t)}))},t}();function h(t){return new p(t)}var y=function(){function t(t){var e=this,r=void 0===t?{}:t,i=r.cacheKeyRoot,a=void 0===i?new c.a(n.e):i,o=r.freezeResults,s=void 0!==o&&o,u=this.executeStoreQuery,l=this.executeSelectionSet,d=this.executeSubSelectedArray;this.freezeResults=s,this.executeStoreQuery=Object(c.b)((function(t){return u.call(e,t)}),{makeCacheKey:function(t){var e=t.query,r=t.rootValue,i=t.contextValue,n=t.variableValues,o=t.fragmentMatcher;if(i.store instanceof p)return a.lookup(i.store,e,o,JSON.stringify(n),r.id)}}),this.executeSelectionSet=Object(c.b)((function(t){return l.call(e,t)}),{makeCacheKey:function(t){var e=t.selectionSet,r=t.rootValue,i=t.execContext;if(i.contextValue.store instanceof p)return a.lookup(i.contextValue.store,e,i.fragmentMatcher,JSON.stringify(i.variableValues),r.id)}}),this.executeSubSelectedArray=Object(c.b)((function(t){return d.call(e,t)}),{makeCacheKey:function(t){var e=t.field,r=t.array,i=t.execContext;if(i.contextValue.store instanceof p)return a.lookup(i.contextValue.store,e,r,JSON.stringify(i.variableValues))}})}return t.prototype.readQueryFromStore=function(t){return this.diffQueryAgainstStore(Object(i.a)({},t,{returnPartialData:!1})).result},t.prototype.diffQueryAgainstStore=function(t){var e=t.store,r=t.query,i=t.variables,a=t.previousResult,c=t.returnPartialData,u=void 0===c||c,l=t.rootId,d=void 0===l?"ROOT_QUERY":l,f=t.fragmentMatcherFunction,p=t.config,h=Object(n.o)(r);i=Object(n.c)({},Object(n.h)(h),i);var y={store:e,dataIdFromObject:p&&p.dataIdFromObject,cacheRedirects:p&&p.cacheRedirects||{}},m=this.executeStoreQuery({query:r,rootValue:{type:"id",id:d,generated:!0,typename:"Query"},contextValue:y,variableValues:i,fragmentMatcher:f}),v=m.missing&&m.missing.length>0;return v&&!u&&m.missing.forEach((function(t){if(!t.tolerable)throw new s.a(8)})),a&&Object(o.a)(a,m.result)&&(m.result=a),{result:m.result,complete:!v}},t.prototype.executeStoreQuery=function(t){var e=t.query,r=t.rootValue,i=t.contextValue,a=t.variableValues,o=t.fragmentMatcher,c=void 0===o?v:o,s=Object(n.l)(e),u=Object(n.j)(e),l={query:e,fragmentMap:Object(n.g)(u),contextValue:i,variableValues:a,fragmentMatcher:c};return this.executeSelectionSet({selectionSet:s.selectionSet,rootValue:r,execContext:l})},t.prototype.executeSelectionSet=function(t){var e=this,r=t.selectionSet,a=t.rootValue,o=t.execContext,c=o.fragmentMap,u=o.contextValue,l=o.variableValues,d={result:null},f=[],p=u.store.get(a.id),h=p&&p.__typename||"ROOT_QUERY"===a.id&&"Query"||void 0;function y(t){var e;return t.missing&&(d.missing=d.missing||[],(e=d.missing).push.apply(e,t.missing)),t.result}return r.selections.forEach((function(t){var r;if(Object(n.F)(t,l))if(Object(n.t)(t)){var d=y(e.executeField(p,h,t,o));void 0!==d&&f.push(((r={})[Object(n.E)(t)]=d,r))}else{var m=void 0;if(Object(n.v)(t))m=t;else if(!(m=c[t.name.value]))throw new s.a(9);var v=m.typeCondition&&m.typeCondition.name.value,b=!v||o.fragmentMatcher(a,v,u);if(b){var O=e.executeSelectionSet({selectionSet:m.selectionSet,rootValue:a,execContext:o});"heuristic"===b&&O.missing&&(O=Object(i.a)({},O,{missing:O.missing.map((function(t){return Object(i.a)({},t,{tolerable:!0})}))})),f.push(y(O))}}})),d.result=Object(n.B)(f),this.freezeResults,d},t.prototype.executeField=function(t,e,r,i){var a=i.variableValues,o=i.contextValue,c=function(t,e,r,i,a,o){o.resultKey;var c=o.directives,s=r;(i||c)&&(s=Object(n.p)(s,i,c));var u=void 0;if(t&&void 0===(u=t[s])&&a.cacheRedirects&&"string"==typeof e){var l=a.cacheRedirects[e];if(l){var d=l[r];d&&(u=d(t,i,{getCacheKey:function(t){var e=a.dataIdFromObject(t);return e&&Object(n.H)({id:e,typename:t.__typename})}}))}}if(void 0===u)return{result:u,missing:[{object:t,fieldName:s,tolerable:!1}]};Object(n.w)(u)&&(u=u.json);return{result:u}}(t,e,r.name.value,Object(n.b)(r,a),o,{resultKey:Object(n.E)(r),directives:Object(n.i)(r,a)});return Array.isArray(c.result)?this.combineExecResults(c,this.executeSubSelectedArray({field:r,array:c.result,execContext:i})):r.selectionSet?null==c.result?c:this.combineExecResults(c,this.executeSelectionSet({selectionSet:r.selectionSet,rootValue:c.result,execContext:i})):(m(r,c.result),this.freezeResults,c)},t.prototype.combineExecResults=function(){for(var t,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.forEach((function(e){e.missing&&(t=t||[]).push.apply(t,e.missing)})),{result:e.pop().result,missing:t}},t.prototype.executeSubSelectedArray=function(t){var e,r=this,i=t.field,a=t.array,n=t.execContext;function o(t){return t.missing&&(e=e||[]).push.apply(e,t.missing),t.result}return a=a.map((function(t){return null===t?null:Array.isArray(t)?o(r.executeSubSelectedArray({field:i,array:t,execContext:n})):i.selectionSet?o(r.executeSelectionSet({selectionSet:i.selectionSet,rootValue:t,execContext:n})):(m(i,t),t)})),this.freezeResults,{result:a,missing:e}},t}();function m(t,e){if(!t.selectionSet&&Object(n.u)(e))throw new s.a(10)}function v(){return!0}var b=function(){function t(t){void 0===t&&(t=Object.create(null)),this.data=t}return t.prototype.toObject=function(){return this.data},t.prototype.get=function(t){return this.data[t]},t.prototype.set=function(t,e){this.data[t]=e},t.prototype.delete=function(t){this.data[t]=void 0},t.prototype.clear=function(){this.data=Object.create(null)},t.prototype.replace=function(t){this.data=t||Object.create(null)},t}();var O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="WriteError",e}return Object(i.c)(e,t),e}(Error);var g=function(){function t(){}return t.prototype.writeQueryToStore=function(t){var e=t.query,r=t.result,i=t.store,a=void 0===i?h():i,n=t.variables,o=t.dataIdFromObject,c=t.fragmentMatcherFunction;return this.writeResultToStore({dataId:"ROOT_QUERY",result:r,document:e,store:a,variables:n,dataIdFromObject:o,fragmentMatcherFunction:c})},t.prototype.writeResultToStore=function(t){var e=t.dataId,r=t.result,i=t.document,a=t.store,o=void 0===a?h():a,c=t.variables,s=t.dataIdFromObject,u=t.fragmentMatcherFunction,l=Object(n.m)(i);try{return this.writeSelectionSetToStore({result:r,dataId:e,selectionSet:l.selectionSet,context:{store:o,processedData:{},variables:Object(n.c)({},Object(n.h)(l),c),dataIdFromObject:s,fragmentMap:Object(n.g)(Object(n.j)(i)),fragmentMatcherFunction:u}})}catch(t){throw function(t,e){var r=new O("Error writing result to store for query:\n "+JSON.stringify(e));return r.message+="\n"+t.message,r.stack=t.stack,r}(t,i)}},t.prototype.writeSelectionSetToStore=function(t){var e=this,r=t.result,i=t.dataId,a=t.selectionSet,o=t.context,c=o.variables,u=o.store,l=o.fragmentMap;return a.selections.forEach((function(t){var a;if(Object(n.F)(t,c))if(Object(n.t)(t)){var u=Object(n.E)(t),d=r[u];if(void 0!==d)e.writeFieldToStore({dataId:i,value:d,field:t,context:o});else{var f=!1,p=!1;t.directives&&t.directives.length&&(f=t.directives.some((function(t){return t.name&&"defer"===t.name.value})),p=t.directives.some((function(t){return t.name&&"client"===t.name.value}))),!f&&!p&&o.fragmentMatcherFunction}}else{var h=void 0;Object(n.v)(t)?h=t:(h=(l||{})[t.name.value],Object(s.b)(h,2));var y=!0;if(o.fragmentMatcherFunction&&h.typeCondition){var m=i||"self",v=Object(n.H)({id:m,typename:void 0}),O={store:new b((a={},a[m]=r,a)),cacheRedirects:{}},g=o.fragmentMatcherFunction(v,h.typeCondition.name.value,O);Object(n.x)(),y=!!g}y&&e.writeSelectionSetToStore({result:r,selectionSet:h.selectionSet,dataId:i,context:o})}})),u},t.prototype.writeFieldToStore=function(t){var e,r,a,c=t.field,u=t.value,l=t.dataId,d=t.context,f=d.variables,p=d.dataIdFromObject,h=d.store,y=Object(n.G)(c,f);if(c.selectionSet&&null!==u)if(Array.isArray(u)){var m=l+"."+y;r=this.processArrayValue(u,m,c.selectionSet,d)}else{var v=l+"."+y,b=!0;if(j(v)||(v="$"+v),p){var O=p(u);Object(s.b)(!O||!j(O),3),(O||"number"==typeof O&&0===O)&&(v=O,b=!1)}S(v,c,d.processedData)||this.writeSelectionSetToStore({dataId:v,result:u,selectionSet:c.selectionSet,context:d});var g=u.__typename;r=Object(n.H)({id:v,typename:g},b);var x=(a=h.get(l))&&a[y];if(x!==r&&Object(n.u)(x)){var R=void 0!==x.typename,w=void 0!==g,I=R&&w&&x.typename!==g;Object(s.b)(!b||x.generated||I,4),Object(s.b)(!R||w,5),x.generated&&(I?b||h.delete(x.id):function t(e,r,a){if(e===r)return!1;var c=a.get(e),s=a.get(r),u=!1;Object.keys(c).forEach((function(e){var r=c[e],i=s[e];Object(n.u)(r)&&j(r.id)&&Object(n.u)(i)&&!Object(o.a)(r,i)&&t(r.id,i.id,a)&&(u=!0)})),a.delete(e);var l=Object(i.a)({},c,s);if(Object(o.a)(l,s))return u;return a.set(r,l),!0}(x.id,r.id,h))}}else r=null!=u&&"object"==typeof u?{type:"json",json:u}:u;(a=h.get(l))&&Object(o.a)(r,a[y])||h.set(l,Object(i.a)({},a,((e={})[y]=r,e)))},t.prototype.processArrayValue=function(t,e,r,i){var a=this;return t.map((function(t,o){if(null===t)return null;var c=e+"."+o;if(Array.isArray(t))return a.processArrayValue(t,c,r,i);var s=!0;if(i.dataIdFromObject){var u=i.dataIdFromObject(t);u&&(c=u,s=!1)}return S(c,r,i.processedData)||a.writeSelectionSetToStore({dataId:c,result:t,selectionSet:r,context:i}),Object(n.H)({id:c,typename:t.__typename},s)}))},t}();function j(t){return"$"===t[0]}function S(t,e,r){if(!r)return!1;if(r[t]){if(r[t].indexOf(e)>=0)return!0;r[t].push(e)}else r[t]=[e];return!1}var x={fragmentMatcher:new d,dataIdFromObject:function(t){if(t.__typename){if(void 0!==t.id)return t.__typename+":"+t.id;if(void 0!==t._id)return t.__typename+":"+t._id}return null},addTypename:!0,resultCaching:!0,freezeResults:!1};var R=Object.prototype.hasOwnProperty,w=function(t){function e(e,r,i){var a=t.call(this,Object.create(null))||this;return a.optimisticId=e,a.parent=r,a.transaction=i,a}return Object(i.c)(e,t),e.prototype.toObject=function(){return Object(i.a)({},this.parent.toObject(),this.data)},e.prototype.get=function(t){return R.call(this.data,t)?this.data[t]:this.parent.get(t)},e}(b),I=function(t){function e(e){void 0===e&&(e={});var r=t.call(this)||this;r.watches=new Set,r.typenameDocumentCache=new Map,r.cacheKeyRoot=new c.a(n.e),r.silenceBroadcast=!1,r.config=Object(i.a)({},x,e),r.config.customResolvers&&(r.config.cacheRedirects=r.config.customResolvers),r.config.cacheResolvers&&(r.config.cacheRedirects=r.config.cacheResolvers),r.addTypename=!!r.config.addTypename,r.data=r.config.resultCaching?new p:new b,r.optimisticData=r.data,r.storeWriter=new g,r.storeReader=new y({cacheKeyRoot:r.cacheKeyRoot,freezeResults:e.freezeResults});var a=r,o=a.maybeBroadcastWatch;return r.maybeBroadcastWatch=Object(c.b)((function(t){return o.call(r,t)}),{makeCacheKey:function(t){if(!t.optimistic&&!t.previousResult)return a.data instanceof p?a.cacheKeyRoot.lookup(t.query,JSON.stringify(t.variables)):void 0}}),r}return Object(i.c)(e,t),e.prototype.restore=function(t){return t&&this.data.replace(t),this},e.prototype.extract=function(t){return void 0===t&&(t=!1),(t?this.optimisticData:this.data).toObject()},e.prototype.read=function(t){if("string"==typeof t.rootId&&void 0===this.data.get(t.rootId))return null;var e=this.config.fragmentMatcher,r=e&&e.match;return this.storeReader.readQueryFromStore({store:t.optimistic?this.optimisticData:this.data,query:this.transformDocument(t.query),variables:t.variables,rootId:t.rootId,fragmentMatcherFunction:r,previousResult:t.previousResult,config:this.config})||null},e.prototype.write=function(t){var e=this.config.fragmentMatcher,r=e&&e.match;this.storeWriter.writeResultToStore({dataId:t.dataId,result:t.result,variables:t.variables,document:this.transformDocument(t.query),store:this.data,dataIdFromObject:this.config.dataIdFromObject,fragmentMatcherFunction:r}),this.broadcastWatches()},e.prototype.diff=function(t){var e=this.config.fragmentMatcher,r=e&&e.match;return this.storeReader.diffQueryAgainstStore({store:t.optimistic?this.optimisticData:this.data,query:this.transformDocument(t.query),variables:t.variables,returnPartialData:t.returnPartialData,previousResult:t.previousResult,fragmentMatcherFunction:r,config:this.config})},e.prototype.watch=function(t){var e=this;return this.watches.add(t),function(){e.watches.delete(t)}},e.prototype.evict=function(t){throw new s.a(1)},e.prototype.reset=function(){return this.data.clear(),this.broadcastWatches(),Promise.resolve()},e.prototype.removeOptimistic=function(t){for(var e=[],r=0,i=this.optimisticData;i instanceof w;)i.optimisticId===t?++r:e.push(i),i=i.parent;if(r>0){for(this.optimisticData=i;e.length>0;){var a=e.pop();this.performTransaction(a.transaction,a.optimisticId)}this.broadcastWatches()}},e.prototype.performTransaction=function(t,e){var r=this.data,i=this.silenceBroadcast;this.silenceBroadcast=!0,"string"==typeof e&&(this.data=this.optimisticData=new w(e,this.optimisticData,t));try{t(this)}finally{this.silenceBroadcast=i,this.data=r}this.broadcastWatches()},e.prototype.recordOptimisticTransaction=function(t,e){return this.performTransaction(t,e)},e.prototype.transformDocument=function(t){if(this.addTypename){var e=this.typenameDocumentCache.get(t);return e||(e=Object(n.a)(t),this.typenameDocumentCache.set(t,e),this.typenameDocumentCache.set(e,e)),e}return t},e.prototype.broadcastWatches=function(){var t=this;this.silenceBroadcast||this.watches.forEach((function(e){return t.maybeBroadcastWatch(e)}))},e.prototype.maybeBroadcastWatch=function(t){t.callback(this.diff({query:t.query,variables:t.variables,previousResult:t.previousResult&&t.previousResult(),optimistic:t.optimistic}))},e}(a.a)}}]);
//# sourceMappingURL=npm.apollo-cache-inmemory.js.map